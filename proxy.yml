version: '2'
services:
  mitmproxy:
    container_name: proxy
    image: mitmproxy/mitmproxy
    network_mode: "host"
    extra_hosts:
    - "bc-host:127.0.0.1"
    - "default:127.0.0.1"
    restart: always
    command: mitmweb --ssl-insecure --web-host 0.0.0.0 --web-port 8081 -s /data/scripts/redirect.py --no-http2 -s /data/scripts/modify_response.py
    environment:
      - TZ="America/Bogota"
      - SSH_PORT=41
    volumes:
      - "./data/proxy:/data"
    ports:
      - 8080:8080
      - 8081:8081

  castlemock:
    container_name: castlemock
    image: castlemock/castlemock:1.51
    restart: always
    volumes:
      - "./data/castlemock:/root/.castlemock"
    ports:
      - 80:8080
